# Architecture
![Architecture Diagram](https://github.com/wanghytosky/NumberService/blob/master/image/Architecture.jpeg?raw=true)

# NumberService
![Architecture Diagram](https://github.com/wanghytosky/NumberService/blob/master/image/numberservice.png?raw=true)


# CND 
Content Distribution Network is used to speed up client access and provides protection from large surges in traffic to mitigate the load pressure. 

# FireWall
Ensure security.

# LVS
Load balancing improves the distribution of workloads (requests from clients) across multiple clusters.

# Nginx
Following the URL address rules, nginx distributes multiple request from clients to the corresponding server.

# Redis
Based pubsub pattern (publish-subscribe pattern) and types of list data, implement message queue over redis to maximize the throughput.  

# Solr
Catching the history information by Solr maximizes the efficiency of query to status/history. Index is updated hourly. 

# DataBase Design
![Architecture Diagram](https://github.com/wanghytosky/NumberService/blob/master/image/database.png?raw=true)

# Database overview
* **customer table**: maintains customer's information.</br>
	&#8195;&#8195;&#8195;cus_id (int)&#8195;: primary key, id of each customer.</br>
	&#8195;&#8195;&#8195;cus_name (varchar)&#8195;: name of each customer.</br>
	&#8195;&#8195;&#8195;activated (tinyint)&#8195;: whether the customer account is activated (1: yes; 0: no).</br></br>
* **number table**: maintains numbers’ information.</br>
	&#8195;&#8195;&#8195;num_id (int)&#8195;: primary key, id of each number. </br>
	&#8195;&#8195;&#8195;cus_id (int)&#8195;: foreign key to customer table.</br>
	&#8195;&#8195;&#8195;status (tinyint)&#8195;: the number usage state.</br>
	&#8195;&#8195;&#8195;expired_time (datetime)&#8195;: expired time of each number.</br></br>
* **history table**: maintains records for every change. </br>
	&#8195;&#8195;&#8195;history_id (int)&#8195;: primary key, id of each change, generated by UUID.</br>
	&#8195;&#8195;&#8195;num_id (int)&#8195;: foreign key to number table.</br>
	&#8195;&#8195;&#8195;cus_id (int)&#8195;: foreign key to customer table.</br>
	&#8195;&#8195;&#8195;service id(int)&#8195;: foreign key to service table.</br>
	&#8195;&#8195;&#8195;status_id_from (tinyint)&#8195;: the status before update.</br>
	&#8195;&#8195;&#8195;status_id_to (tinyint)&#8195;: the new status.</br>
	&#8195;&#8195;&#8195;create_time (datetime)&#8195;: time of change happens.</br></br>
* **status table**: maintains status information. </br>
	&#8195;&#8195;&#8195;status_id (tinyint)&#8195;: primary key, id of each status.</br>
	&#8195;&#8195;&#8195;status_name (varchar)&#8195;: the name of the status (0: available 1: in use; 2: pause; 3: disabled).</br>
	&#8195;&#8195;&#8195;description (varchar)&#8195;: describe the details of the status.</br></br>
* **service table**: maintains service information. </br>
	&#8195;&#8195;&#8195;service_id (int)&#8195;: primary key, id of each service.</br>
	&#8195;&#8195;&#8195;service_name (varchar)&#8195;: the name of the service, such as prepaid, contract.</br>
	&#8195;&#8195;&#8195;service_type (tinyint)&#8195;: 0->Prepaid 1->contact .</br>
	&#8195;&#8195;&#8195;description (varchar)&#8195;: describe the details of the service.</br>
	&#8195;&#8195;&#8195;expired_date(datetime)&#8195;: The service cannot be used after the date.</br>
